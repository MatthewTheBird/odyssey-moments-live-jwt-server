<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ably History</title>
  </head>
  <body>
    <script src="https://cdn.ably.com/lib/ably.min-1.js"></script>
    <script>
      const apiKey =
        "3HiHNg.WRNCdQ:XL7G5jGarwYU3l_Zege-cVx3985Lv_FaW_VJI0-PYXc"; // Replace with your API key
      const realtime = new Ably.Realtime.Promise({
        key: apiKey,
      });

      async function doHistory() {
        // Connect to Ably
        await realtime.connection.once("connected");
        console.log("Connected to Ably!");
        // Your code goes here
        const channel = realtime.channels.get("persisted:sounds");
        channel.publish("play", "bark");
        channel.publish("play", "meow");
        channel.publish("play", "cluck");

        channel.history((err, resultPage) => {
          // display last message published
          const [lastMessage] = resultPage.items;
          console.log("Last message published:", lastMessage.data);

          // list all history items
          console.table(resultPage.items);
        });
      }
      doHistory();
    </script>
  </body>
</html>
